{"version":3,"sources":["../../src/controller/message.js"],"names":["config","db","api","post","authenticate","req","res","newMessage","Message","messageBody","body","userId","channelId","userName","userAvatar","userAvatarColor","save","err","status","json","message","put","findById","params","id","get","find","messages","delete","remove","_id","users"],"mappings":"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","file":"message.js","sourcesContent":["import mongoose from 'mongoose';\nimport { Router } from 'express';\nimport bodyParser from 'body-parser';\nimport Message from '../model/message';\n\nimport { authenticate } from '../middleware/authMiddleware';\n\nexport default({ config, db }) => {\n  let api = Router();\n\n  // '/v1/message/add' - Create\n  api.post('/add', authenticate, (req, res) => {\n    let newMessage = new Message();\n    newMessage.messageBody = req.body.messageBody;\n    newMessage.userId = req.body.userId;\n    newMessage.channelId = req.body.channelId;\n    newMessage.userName = req.body.userName;\n    newMessage.userAvatar = req.body.userAvatar;\n    newMessage.userAvatarColor = req.body.userAvatarColor;\n\n    newMessage.save(err => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'Message saved successfully' })\n    });\n  });\n\n  // '/v1/message/:id' - Update\n  api.put('/:id', authenticate, (req, res) => {\n    Message.findById(req.params.id, (err, message) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      message.messageBody = req.body.messageBody;\n      message.userId = req.body.userId;\n      message.channelId = req.body.channelId;\n      newMessage.userName = req.body.userName;\n      newMessage.userAvatar = req.body.userAvatar;\n      newMessage.userAvatarColor = req.body.userAvatarColor;\n\n      message.save(err => {\n        if (err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json({ message: 'Message updated' });\n      });\n    });\n  });\n\n  // '/v1/message/byChannel/:channelId'\n  api.get('/byChannel/:channelId', authenticate, (req, res) => {\n    Message\n      .find({ 'channelId' : req.params.channelId }, (err, messages) => {\n        if(err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json(messages);\n      });\n  });\n\n  // '/vq/message/:id' -Delete\n  api.delete('/:id', authenticate, (req, res) => {\n    Message.remove({\n      _id: req.params.id\n    }, (err, message) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'Message Successfully Removed'});\n    });\n  });\n\n  // '/v1/message/' - Delete all\n  api.delete('/', authenticate, (req, res) => {\n    Message.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'Users All Removed'});\n    });\n  });\n\n  return api;\n}\n"]}