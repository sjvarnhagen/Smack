{"version":3,"sources":["../../src/controller/user.js"],"names":["config","db","api","post","authenticate","req","res","newUser","User","name","body","email","avatarName","avatarColor","save","err","status","json","message","get","find","users","findById","params","id","user","put","findOne","exec","userData","delete","remove","_id"],"mappings":"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","file":"user.js","sourcesContent":["import mongoose from 'mongoose';\nimport { Router } from 'express';\nimport bodyParser from 'body-parser';\nimport User from '../model/user';\n\nimport { authenticate } from '../middleware/authMiddleware';\n\nexport default({ config, db }) => {\n  let api = Router();\n\n  // '/v1/user/add' - Create\n  api.post('/add', authenticate, (req, res) => {\n    let newUser = new User();\n    newUser.name = req.body.name;\n    newUser.email = req.body.email;\n    newUser.avatarName = req.body.avatarName;\n    newUser.avatarColor = req.body.avatarColor;\n\n    newUser.save(err => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(newUser);\n    });\n  });\n\n  // '/v1/user/' - Read\n  api.get('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(users);\n    });\n  });\n\n  // '/v1/user/:id' - Read 1\n  api.get('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json(user);\n    });\n  });\n\n  // '/v1/user/:id' - Update\n  api.put('/:id', authenticate, (req, res) => {\n    User.findById(req.params.id, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      user.name = req.body.name;\n      user.email = req.body.email;\n      user.avatarName = req.body.avatarName;\n      user.avatarColor = req.body.avatarColor;\n      user.save(err => {\n        if (err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json({ message: 'User info updated' });\n      });\n    });\n  });\n\n  // 'v1/user/byEmail/:email'\n  api.get('/byEmail/:email', authenticate, (req, res) => {\n    User\n      .findOne({ 'email': req.params.email })\n      .exec((err, userData) => {\n        if (err) {\n          res.status(500).json({ message: err });\n        }\n        res.status(200).json(userData);\n      });\n  });\n\n  // '/vq/user/:id' -Delete\n  api.delete('/:id', authenticate, (req, res) => {\n    User.remove({\n      _id: req.params.id\n    }, (err, user) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'User Successfully Removed'});\n    });\n  });\n\n  // '/v1/user/' - Delete all\n  api.delete('/', authenticate, (req, res) => {\n    User.find({}, (err, users) => {\n      if (err) {\n        res.status(500).json({ message: err });\n      }\n      res.status(200).json({ message: 'Users All Removed'});\n    });\n  });\n\n  return api;\n}\n"]}